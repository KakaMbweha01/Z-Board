<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Student Notifications</title>
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    </head>
    <body class="container mt-4">
        <h2 class="mb-3">Notifications</h2>
        <!-- search bar form-->
        <form method="GET" class="mb-3">
            <input type="text" name="q" class="form-control" placeholder="Search notifications..." value="{{ query }}">
            <!-- filter by category-->
            <select name="category" class="form-control mt-2">
                <option value="">All Categories</option>
                <option value="general" {% if category_filter == 'general' %}selected{% endif %}>General</option>
                <option value="exams" {% if category_filter == 'exams' %}selected{% endif %}>Exams</option>
                <option value="events" {% if category_filter == 'events' %}selected{% endif %}>Events</option>
                <option value="deadlines" {% if category_filter == 'deadlines' %}selected{% endif %}>Deadlines</option>
            </select>
            <button type="submit" class="btn btn-primary mt-2">Search</button>
        </form>
        <!-- Notification Form-->
        <div class="mb-3">
            {% if user.is_authenticated %}
                <p>Welcome, {{ user.username }}! <a href="{% url 'logout' %}" class="btn btn-danger">Logout</a></p>

                {% if user.is_staff %}
                    <form method="POST" class="mb-3">
                        {% csrf_token %}
                        <div class="mb-2">
                            <input type="text" name="title" class="form-control" placeholder="TITLE" required>
                        </div>
                        <div class="mb-2">
                            <textarea name="message" class="form-control" placeholder="Message" required></textarea>
                        </div>
                        <div class="mb-2">
                            <select name="category" class="form-control" required>
                                <option value="general">General</option>
                                <option value="exams">Exams</option>
                                <option value="events">Events</option>
                                <option value="deadlines">Deadlines</option>
                            </select>
                        <button type="submit" class="btn btn-primary">Post Notfication</button>
                    </form>
                {% else %}
                    <p class="text-info">You are logged in as a student. You can view notifications but cannot post.</p>
                {% endif %}
            {% else %}
                <a href="{% url 'login' %}" class="btn btn-success">Login</a>
                <a href="{% url 'signup' %}" class="btn btn-primary">Sign Up</a>
            {% endif %}
        </div>

        <!-- Notification List-->
        <div class="list-group">
            {% for notification in notifications %}
                <div class="list-group-item">
                    <h5 class="mb-1">{{ notification.title }}</h5>
                    <p class="mb-1">{{ notification.message }}</p>
                    <small class="text-muted">{{ notification.created_at}}</small>
                </div>
            {% empty %}
                <p>No notifications available.</p>
            {% endfor %}
            </div>
    </body>
</html>